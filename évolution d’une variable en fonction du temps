import os
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from datetime import datetime as dt



os.chdir('C:\\Users\\22bla\\Documents\\Damien Ecole\\Info')

df=pd.read_csv('EIVP_KM.csv', sep=';', index_col='sent_at', parse_dates=True)  #on ouvre le fichier excel



##L’évolution d’une variable en fonction du temps

#On crée une bibliothèque 'unites' pour pouvoir assimiler à une variable son unité de mesure puis l'afficher sur l'axe des ordonnées. Une bibliotèque 'variable_dico' pour traduire les noms des variables en français pour l'intitulé du graphique:

unites={ 'temp':'°C', 'noise':'dBA' , 'lum':'lux', 'co2':'ppm' , 'humidity':'%' }
variable_dico={'temp':'température','noise':'bruit','lum':'luminosité','co2':'CO_2','humidity':'humidité relative'}

#La fonction 'evolution' permet d'afficher l'evolution d'une variable en fonction du temps si on précise la variable, la plage horaire ('d' et 'f') et la liste 'L' des capteurs qu'on souhaite analyser:

def evolution():
        variable=input('entrer une variable (temp,humidity,co2,noise,lum):')
        d=input('entrer date début (exemple 2020-09):')
        f=input('entrer date fin:')
        L=[int(el) for el in input('choix des capteurs de 1 à 6 (ex: 1 3 5):').split()]
        
        
        for k in range(len(L)):  #on parcourt la liste des capteurs sélectionnés
                df[df['id']==L[k]][variable][d:f].plot(label=f' capteur {L[k]}') # et on dessine le graphique correspondant au capteur 'id' pour la variable et la plage horaire choisies
        plt.title( 'Evolution de la ' + variable_dico[f'{variable}'])
        plt.ylabel(unites[f'{variable}'])
        plt.legend()               
        plt.show()
